(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     53406,       1321]
NotebookOptionsPosition[     51263,       1245]
NotebookOutlinePosition[     51617,       1261]
CellTagsIndexPosition[     51574,       1258]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[StyleBox["The Living Shrimp Problem and the Multinomial \
Distribution", "Subtitle",
 FontSize->16]], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.601558704453348*^9, 3.601558830439849*^9}, {
   3.601628594364409*^9, 3.601628628190791*^9}, 3.601628758880187*^9, {
   3.601628799389217*^9, 3.601629176903942*^9}},
 FormatType->"TextForm"],

Cell[TextData[{
 StyleBox["\n", "Subtitle",
  FontSize->16],
 StyleBox["\n",
  FontSize->14],
 StyleBox["Suppose you have two shrimp in a unit square.\n\nLet x be \
probabilty that food pellet lands in shrimp circle 1\nLet y be probabilty \
that food pellet lands in shrimp circle 2\nLet z be probabilty that food \
pellet doesn' t land in either shrimp circle\n\nIf you toss 3 food pellets \
into square then distribution is given by multinomial distribution.\n\nLet k1 \
be number of food pellets in circle 1\nLet k2 be number of food pellets in \
circle 2\nLet k2 be number of food pellets in neither circle 1 or 2.\nWe have \
k1+k2+k3 = 3 food pellets\n\nThen :\n  P (k1, k2, k3) = Multinomial[k1, k2, \
k3] ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "k1"], " ", 
    SuperscriptBox["y", "k2"], " ", 
    SuperscriptBox["z", "k3"]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["  = ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     SuperscriptBox["x", "k1"], " ", 
     SuperscriptBox["y", "k2"], " ", 
     SuperscriptBox["z", "k3"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"k1", "+", "k2", "+", "k3"}], ")"}], "!"}]}], 
    RowBox[{
     RowBox[{"k1", "!"}], " ", 
     RowBox[{"k2", "!"}], " ", 
     RowBox[{"k3", "!"}]}]], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["\n  \n  which is the monomial term in the expansion of",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"x", "+", "y", "+", "z"}], ")"}], "3"]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox[" with exponents k1, k2, k3\n\n",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"x", "+", "y", "+", "z"}], ")"}], "3"], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox[" = ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "3"], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"], " ", "y"}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"], " ", "z"}], "+", 
    RowBox[{"3", " ", "x", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"6", " ", "x", " ", "y", " ", "z"}], "+", 
    RowBox[{"3", " ", "x", " ", 
     SuperscriptBox["z", "2"]}], "+", 
    SuperscriptBox["y", "3"], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["y", "2"], " ", "z"}], "+", 
    RowBox[{"3", " ", "y", " ", 
     SuperscriptBox["z", "2"]}], "+", 
    SuperscriptBox["z", "3"]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["\n\nFor example: \nprobability that all three pellets land outside \
of shrimp circles is P(0,0,3) = ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"3", "!"}], " ", 
      SuperscriptBox["x", "0"], " ", 
      SuperscriptBox["y", "0"], " ", 
      SuperscriptBox["z", "3"]}], 
     RowBox[{
      RowBox[{"3", "!"}], " ", 
      RowBox[{"0", "!"}], " ", 
      RowBox[{"0", "!"}]}]], "=", 
    SuperscriptBox["z", "3"]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["\nprobability that two pellets land outside of two shrimp circle \
and one pellet lands in circle  is P(1,0,2) = ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"3", "!"}], " ", 
      SuperscriptBox["x", "1"], " ", 
      SuperscriptBox["y", "0"], " ", 
      SuperscriptBox["z", "2"]}], 
     RowBox[{
      RowBox[{"2", "!"}], " ", 
      RowBox[{"1", "!"}], " ", 
      RowBox[{"0", "!"}]}]], "=", 
    RowBox[{"3", " ", 
     SuperscriptBox["z", "2"], " ", "y"}]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["\n  \nSo to compute probability that zero shrimp lives we should \
add up all monomial terms which don't contain x or y namely ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["z", "3"], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["\n\nTo compute probability that one shrimp lives we should add up \
all monomial terms which include only x or y or (x and z) or (y and z) terms \
namely: ",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "3"], "+", " ", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"], " ", "z"}], "+", 
    RowBox[{"3", " ", "x", " ", 
     SuperscriptBox["z", "2"]}], "+", 
    SuperscriptBox["y", "3"], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["y", "2"], " ", "z"}], "+", 
    RowBox[{"3", " ", "y", " ", 
     SuperscriptBox["z", "2"]}]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["\n\nTo compute probability that two shrimps live we should add up \
all monomial terms which include x and y and z or ( x and y) namely:\n",
  FontSize->14,
  FontWeight->"Plain"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"], " ", "y"}], "+", 
    RowBox[{"3", " ", "x", " ", 
     SuperscriptBox["y", "2"]}], "+", 
    RowBox[{"6", " ", "x", " ", "y", " ", "z"}]}], TraditionalForm]],
  FontSize->14,
  FontWeight->"Plain"],
 "\n\n"
}], "Input",
 Evaluatable->False,
 CellChangeTimes->{{3.601558704453348*^9, 3.601558830439849*^9}, {
   3.601628594364409*^9, 3.601628628190791*^9}, 3.601628758880187*^9, {
   3.601628799389217*^9, 3.601629199888747*^9}, {3.601629239249627*^9, 
   3.60162932337814*^9}, {3.601629358432289*^9, 3.601629559907105*^9}, {
   3.601629710731978*^9, 3.6016297625146112`*^9}, {3.601629805612749*^9, 
   3.601629976736744*^9}, {3.601630041702116*^9, 3.6016300939463787`*^9}, 
   3.601630719111836*^9, {3.601630796238258*^9, 3.601631148631789*^9}},
 FormatType->"TextForm",
 FontSize->16],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{
     "p0", ",", "p1", ",", "p2", ",", "x", ",", "y", ",", "z", ",", 
      "probZeroShrimpLives", ",", "probOneShrimpLives", ",", 
      "probTwoShrimpsLive"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probZeroShrimpLives", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", 
     StyleBox[
      RowBox[{" ", 
       StyleBox[" ",
        FontSize->14,
        FontWeight->"Plain"]}]], 
     FormBox[
      SuperscriptBox["z", "3"],
      TraditionalForm]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probOneShrimpLives", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], ":=", " ", 
     FormBox[
      RowBox[{
       SuperscriptBox["x", "3"], "+", " ", 
       RowBox[{"3", " ", 
        SuperscriptBox["x", "2"], " ", "z"}], "+", 
       RowBox[{"3", " ", "x", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       SuperscriptBox["y", "3"], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["y", "2"], " ", "z"}], "+", 
       RowBox[{"3", " ", "y", " ", 
        SuperscriptBox["z", "2"]}]}],
      TraditionalForm]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"probTwoShrimpsLive", "[", 
      RowBox[{"x_", ",", "y_", ",", "z_"}], "]"}], " ", ":=", " ", 
     FormBox[
      RowBox[{
       RowBox[{"3", " ", 
        SuperscriptBox["x", "2"], " ", "y"}], "+", 
       RowBox[{"3", " ", "x", " ", 
        SuperscriptBox["y", "2"]}], "+", 
       RowBox[{"6", " ", "x", " ", "y", " ", "z"}]}],
      TraditionalForm]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.601559124183563*^9, 3.6015592558430023`*^9}, 
   3.601559300170882*^9, {3.601559407667076*^9, 3.601559420612389*^9}, {
   3.601629578655521*^9, 3.601629626191585*^9}, {3.60163116188769*^9, 
   3.601631219334468*^9}, {3.601631318910923*^9, 3.601631326915139*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"x", "=", ".1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y", " ", "=", " ", ".1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z", "=", ".8"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"probZeroShrimpLives", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"probOneShrimpLives", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
     RowBox[{"probTwoShrimpsLive", "[", 
      RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.601559332166527*^9, 3.601559400627141*^9}, {
   3.601559431593603*^9, 3.601559451959569*^9}, {3.601559483272386*^9, 
   3.601559497867408*^9}, 3.601597524367127*^9, {3.6016023095873137`*^9, 
   3.601602345427843*^9}, {3.601602390706799*^9, 3.6016024185846977`*^9}, {
   3.601602453962515*^9, 3.6016025979394407`*^9}, {3.60160262869664*^9, 
   3.601602646775631*^9}, {3.60160269618121*^9, 3.60160285892898*^9}, {
   3.6016029072176332`*^9, 3.601602941605934*^9}, {3.601602998002446*^9, 
   3.601603069834386*^9}, {3.601629610295154*^9, 3.601629686732174*^9}, {
   3.6016312645681458`*^9, 3.601631267013302*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5120000000000001`", ",", "0.43400000000000016`", ",", 
   "0.05400000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{{3.601629663237764*^9, 3.601629687788136*^9}, {
   3.601631224676888*^9, 3.601631236783368*^9}, 3.601631267696844*^9, 
   3.601631330662694*^9, 3.601871482286386*^9, 3.602080579936438*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.601564210620419*^9, 3.601564210639123*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.601564113362311*^9, 3.601564113383431*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["To generalize we use the handy function Probability \
together with the MultinomialDistribution function. Why we have to multiply \
by 2  or Choose(2,1) in probOneShrimpLives is exercise for reader.",
 FontSize->14,
 FontWeight->"Plain"]], "Input",
 CellChangeTimes->{{3.60159397821832*^9, 3.601593997332512*^9}, {
   3.601630102689761*^9, 3.60163011170531*^9}, {3.601630148975074*^9, 
   3.601630169901814*^9}, {3.601630221219467*^9, 3.601630322335129*^9}, {
   3.601630422641447*^9, 3.601630450695695*^9}, 3.601630681231654*^9, {
   3.601631375159576*^9, 3.601631459873191*^9}},
 FontSize->16],

Cell["\<\
Syntax::sntxf: \"alDistribution function. Why we have to multiply by 2  or \
Choose(2\" cannot be followed by \",1) in probOneShrimpLives is exercise for \
reader.\".\
\>", "Message", "MSG",
 CellChangeTimes->{3.6018714823971367`*^9, 3.6020805800994987`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\n", 
  StyleBox[
   RowBox[{
    RowBox[{
     RowBox[{"probZeroShrimpLive", " ", "=", " ", 
      RowBox[{"Probability", "[", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"k1", "==", "0"}], " ", ",", " ", 
          RowBox[{"k2", "==", "0"}], ",", " ", 
          RowBox[{"k3", ">=", "0"}]}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "\[Distributed]", 
         RowBox[{"MultinomialDistribution", "[", 
          RowBox[{"3", ",", 
           RowBox[{"{", 
            RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}]}]}], "]"}]}],
      ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"probOneShrimpLives", " ", "=", " ", 
      RowBox[{"2", "*", 
       RowBox[{"Probability", "[", 
        RowBox[{
         RowBox[{"And", "[", 
          RowBox[{
           RowBox[{"k1", ">", "0"}], " ", ",", " ", 
           RowBox[{"k2", "==", "0"}], ",", " ", 
           RowBox[{"k3", ">=", "0"}]}], "]"}], ",", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "\[Distributed]", 
          RowBox[{"MultinomialDistribution", "[", 
           RowBox[{"3", ",", 
            RowBox[{"{", 
             RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}]}]}], 
        "]"}]}]}], ";"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"probTwoShrimpsLive", " ", "=", " ", 
      RowBox[{"Probability", "[", 
       RowBox[{
        RowBox[{"And", "[", 
         RowBox[{
          RowBox[{"k1", ">", "0"}], " ", ",", " ", 
          RowBox[{"k2", ">", "0"}], ",", " ", 
          RowBox[{"k3", ">=", "0"}]}], "]"}], ",", " ", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "\[Distributed]", 
         RowBox[{"MultinomialDistribution", "[", 
          RowBox[{"3", ",", 
           RowBox[{"{", 
            RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}]}]}], "]"}]}],
      ";"}], "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "probZeroShrimpLive", ",", "probOneShrimpLives", ",", 
      "probTwoShrimpsLive"}], "}"}]}],
   FontSize->12]}]], "Input",
 CellChangeTimes->{{3.60159397821832*^9, 3.601593997332512*^9}, {
  3.601630102689761*^9, 3.60163011170531*^9}, {3.601630148975074*^9, 
  3.601630169901814*^9}, {3.601630221219467*^9, 3.60163038941389*^9}, {
  3.601630452858458*^9, 3.601630532993997*^9}, {3.601637624074869*^9, 
  3.60163764387*^9}, {3.601639169509774*^9, 3.601639184117064*^9}},
 FontSize->16],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5120000000000001`", ",", "0.43400000000000016`", ",", 
   "0.05400000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6016304853140583`*^9, 3.6016305366616077`*^9, 3.60163766165462*^9, {
   3.6016391716173477`*^9, 3.601639177380013*^9}, 3.601639218486356*^9, 
   3.601871482434203*^9, 3.6020805807538023`*^9}]
}, Open  ]],

Cell[TextData[{
 "\n",
 StyleBox["\n",
  FontSize->14],
 StyleBox["In order to generalize this to use an arbitrary number of \
variables we have to be able to programtically create conditions for any \
number of variables and settings. The following functions do this.",
  FontSize->14,
  FontWeight->"Plain"]
}], "Input",
 CellChangeTimes->{{3.601630599898382*^9, 3.60163064364944*^9}, {
  3.6016369457673893`*^9, 3.601636981329299*^9}},
 EmphasizeSyntaxErrors->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "function", " ", "computes", " ", "multinomial", " ", 
    "probabilities", " ", "for", " ", "the", " ", "given", " ", "conditions", 
    " ", "and", " ", "multinomial", " ", "distribution"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"prob", "[", 
     RowBox[{
     "conditions_", ",", "ntrials_", ",", "variables_", ",", "probs_"}], 
     "]"}], ":=", 
    RowBox[{"Probability", "[", 
     RowBox[{
      RowBox[{"And", "@@", "conditions"}], ",", 
      RowBox[{"variables", "\[Distributed]", 
       RowBox[{"MultinomialDistribution", "[", 
        RowBox[{"ntrials", ",", "probs"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"prob", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"k1", "==", "0"}], " ", ",", " ", 
       RowBox[{"k2", "==", "0"}], ",", " ", 
       RowBox[{"k3", ">=", "0"}]}], "}"}], ",", "3", ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Probability", "[", 
    RowBox[{
     RowBox[{"And", "@@", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"k1", "==", "0"}], " ", ",", " ", 
        RowBox[{"k2", "==", "0"}], ",", " ", 
        RowBox[{"k3", ">=", "0"}]}], "}"}]}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "\[Distributed]", 
      RowBox[{"MultinomialDistribution", "[", 
       RowBox[{"3", ",", 
        RowBox[{"{", 
         RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 3.601637330941115*^9}, {
   3.60163749170226*^9, 3.601637500665303*^9}, {3.601637671848463*^9, 
   3.60163773695938*^9}, {3.6016377749659452`*^9, 3.60163778090904*^9}, 
   3.601637823681211*^9, {3.601638377656849*^9, 3.6016383822517443`*^9}, {
   3.601639283196459*^9, 3.601639423072094*^9}}],

Cell[BoxData["0.5120000000000001`"], "Output",
 CellChangeTimes->{{3.601637685892457*^9, 3.601637737509502*^9}, {
   3.601637798570075*^9, 3.601637824294232*^9}, 3.601638387045541*^9, {
   3.60163928392736*^9, 3.601639309776552*^9}, {3.601639350719494*^9, 
   3.601639354646648*^9}, {3.6016393904996*^9, 3.601639401183399*^9}, 
   3.601639460361972*^9, 3.601871482515264*^9, 3.602080581200706*^9}],

Cell[BoxData["0.5120000000000001`"], "Output",
 CellChangeTimes->{{3.601637685892457*^9, 3.601637737509502*^9}, {
   3.601637798570075*^9, 3.601637824294232*^9}, 3.601638387045541*^9, {
   3.60163928392736*^9, 3.601639309776552*^9}, {3.601639350719494*^9, 
   3.601639354646648*^9}, {3.6016393904996*^9, 3.601639401183399*^9}, 
   3.601639460361972*^9, 3.601871482515264*^9, 3.6020805812036657`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "function", " ", "computes", " ", "zero", " ", "conditions", 
    " ", "on", " ", "the", " ", "variables", " ", "example", " ", "use", " ", 
    "and", " ", "output"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"zeroconditions", "[", "vars_", "]"}], ":=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[Equal]", "0"}], "&"}], ",", " ", "vars"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"zeroconditions", "[", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "]"}], " ", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 3.601637330941115*^9}, {
   3.60163749170226*^9, 3.601637500665303*^9}, {3.601637671848463*^9, 
   3.6016376774894257`*^9}, {3.601637836249151*^9, 3.601637840088935*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", "\[Equal]", "0"}], ",", 
   RowBox[{"k2", "\[Equal]", "0"}], ",", 
   RowBox[{"k3", "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6016375043726997`*^9, 3.6016378405229197`*^9, 
  3.601871482586898*^9, 3.602080581402953*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.60163894459048*^9, 3.601638944607286*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "greater", " ", "than", " ", "zero", " ", "conditions"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"probGreaterThanZeroConditions", "[", "vars_", "]"}], ":=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#", ">", "0"}], "&"}], ",", "vars"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"probGreaterThanZeroConditions", "[", 
    RowBox[{"{", 
     RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 
   3.6016372833953257`*^9}, {3.601637373465878*^9, 3.601637438893589*^9}, {
   3.601637519699601*^9, 3.601637530199108*^9}, {3.6016375685641127`*^9, 
   3.6016375927665987`*^9}, {3.601637858080315*^9, 3.601637859015699*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", ">", "0"}], ",", 
   RowBox[{"k2", ">", "0"}], ",", 
   RowBox[{"k3", ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.601637593294314*^9, 3.601637859617158*^9, 
  3.60187148266611*^9, 3.6020805816788273`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "conditions", " ", "for", " ", "k", " ", "shrimp", " ", 
    "to", " ", "live", " ", "excluding", " ", "complement", " ", "of", " ", 
    "shrimp", " ", "circles"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"probkvarstemp", "[", 
      RowBox[{"k_", ",", "vars_"}], "]"}], ":=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"probGreaterThanZeroConditions", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", "vars", "]"}], "-", "k"}], ")"}]}]}], 
        "]"}], "]"}], " ", "~", "Join", "~", " ", 
      RowBox[{"zeroconditions", "[", 
       RowBox[{"Drop", "[", 
        RowBox[{"vars", ",", "k"}], "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"probkvarstemp", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 
   3.6016372833953257`*^9}, {3.601637373465878*^9, 3.601637438893589*^9}, {
   3.601637519699601*^9, 3.601637530199108*^9}, {3.6016375685641127`*^9, 
   3.6016375698291063`*^9}, {3.601637942202126*^9, 3.601638067483692*^9}, {
   3.601638105658032*^9, 3.601638107810894*^9}, {3.601638644680735*^9, 
   3.601638668478991*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", ">", "0"}], ",", 
   RowBox[{"k2", ">", "0"}], ",", 
   RowBox[{"k3", "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6016380352824802`*^9, 3.601638108250613*^9, {3.601638650154993*^9, 
   3.6016386689142017`*^9}, 3.601871482725318*^9, 3.602080581852738*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "create", " ", "conditions", " ", "for", " ", "k", " ", "shrimp", " ", 
    "to", " ", "live", " ", "including", " ", "complement", " ", "of", " ", 
    "shrimp", " ", "circles"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"kvarConditions", "[", 
     RowBox[{"k_", ",", "vars_"}], "]"}], ":=", " ", 
    RowBox[{
     RowBox[{"probkvarstemp", "[", 
      RowBox[{"k", ",", 
       RowBox[{"Drop", "[", 
        RowBox[{"vars", ",", 
         RowBox[{"-", "1"}]}], "]"}]}], "]"}], " ", "~", "Join", "~", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Last", "[", "vars", "]"}], " ", "\[GreaterEqual]", " ", "0"}],
       "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"kvarConditions", "[", 
    RowBox[{"2", ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2", ",", "k3", ",", "k4"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 
   3.6016372833953257`*^9}, {3.601637373465878*^9, 3.601637438893589*^9}, {
   3.601637519699601*^9, 3.601637530199108*^9}, {3.6016375685641127`*^9, 
   3.6016375698291063`*^9}, {3.601637942202126*^9, 3.601638000350876*^9}, {
   3.601638073483047*^9, 3.6016381334582653`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"k1", ">", "0"}], ",", 
   RowBox[{"k2", ">", "0"}], ",", 
   RowBox[{"k3", "\[Equal]", "0"}], ",", 
   RowBox[{"k4", "\[GreaterEqual]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6016381158608418`*^9, 3.601638133872674*^9}, 
   3.601871482769937*^9, 3.6020805820522413`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "compute", " ", "prob", " ", "that", " ", "k", " ", "shrimp", " ", "live",
      " ", "in", " ", "ntrials", "  ", "FOR", " ", "ONLY", " ", "ONE", " ", 
     "INSTANCE"}], ",", " ", 
    RowBox[{"must", " ", "multiply", " ", "by", " ", 
     RowBox[{"Binomial", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "probs", "]"}], "-", "1"}], ",", 
       "nshrimpthatlive"}], "]"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"probkvars", "[", 
      RowBox[{"ntrials_", ",", "k_", ",", "vars_", ",", "probs_"}], "]"}], ":=",
      " ", 
     RowBox[{"prob", "[", 
      RowBox[{
       RowBox[{"kvarConditions", "[", 
        RowBox[{"k", ",", "vars"}], "]"}], ",", "ntrials", ",", "vars", ",", 
       "probs"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"probkvars", "[", 
    RowBox[{"3", ",", "1", ",", 
     RowBox[{"{", 
      RowBox[{"k1", ",", "k2", ",", "k3"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 
   3.6016372833953257`*^9}, {3.601637373465878*^9, 3.601637438893589*^9}, {
   3.601637519699601*^9, 3.601637530199108*^9}, {3.6016375685641127`*^9, 
   3.6016375698291063`*^9}, {3.601637942202126*^9, 3.601638000350876*^9}, {
   3.601638073483047*^9, 3.601638087554441*^9}, {3.6016381618122673`*^9, 
   3.601638250740986*^9}, 3.601638517164209*^9, 3.6016385529921913`*^9, {
   3.601639210467965*^9, 3.6016392200668917`*^9}}],

Cell[BoxData["0.21700000000000008`"], "Output",
 CellChangeTimes->{3.601638203600338*^9, 3.6016385534955873`*^9, 
  3.601871482820696*^9, 3.602080582455976*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "compute", " ", "prob", " ", "that", " ", "k", " ", "shrimp", " ", "live", 
    " ", "in", " ", "ntrials"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"probNShrimpLive", "[", 
     RowBox[{"ntrials_", ",", "nshrimpthatlive_", ",", "probs_"}], "]"}], ":=",
     "  ", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "foox", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Binomial", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "probs", "]"}], "-", "1"}], ",", 
         "nshrimpthatlive"}], "]"}], " ", "*", 
       RowBox[{"probkvars", "[", 
        RowBox[{"ntrials", ",", "nshrimpthatlive", ",", 
         RowBox[{"Map", "[", 
          RowBox[{"foox", ",", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "probs", "]"}], "]"}]}], "]"}], ",", 
         "probs"}], "]"}]}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.60159400525021*^9, 3.6015940681928*^9}, {
   3.601594635580361*^9, 3.601594734774082*^9}, {3.6015947738840237`*^9, 
   3.6015950359763927`*^9}, {3.601595102546195*^9, 3.6015951245563927`*^9}, {
   3.601595223779718*^9, 3.601595457559935*^9}, {3.601595491428484*^9, 
   3.6015955107316933`*^9}, {3.601595553947057*^9, 3.6015955792411423`*^9}, {
   3.601596182479149*^9, 3.601596284683728*^9}, {3.601596335199318*^9, 
   3.60159641779429*^9}, {3.601596495241502*^9, 3.601596698395211*^9}, {
   3.601596750704692*^9, 3.6015969728832407`*^9}, {3.601597217363846*^9, 
   3.601597282406515*^9}, 3.601597341395392*^9, {3.601597389152471*^9, 
   3.601597407583806*^9}, {3.601597481665461*^9, 3.601597481963132*^9}, {
   3.601606089130805*^9, 3.601606123095193*^9}, 3.6016061780607843`*^9, {
   3.601606219627776*^9, 3.601606232450453*^9}, {3.60160628245334*^9, 
   3.601606299790678*^9}, {3.601606344906397*^9, 3.601606374444159*^9}, {
   3.601606406127556*^9, 3.60160643522304*^9}, 3.60160648275836*^9, {
   3.601636986162146*^9, 3.601637016723167*^9}, {3.601637054767501*^9, 
   3.6016371035899343`*^9}, {3.6016371624065657`*^9, 
   3.6016372833953257`*^9}, {3.601637373465878*^9, 3.601637438893589*^9}, {
   3.601637519699601*^9, 3.601637530199108*^9}, {3.6016375685641127`*^9, 
   3.6016375698291063`*^9}, {3.601637942202126*^9, 3.601638000350876*^9}, {
   3.601638073483047*^9, 3.601638087554441*^9}, {3.6016381618122673`*^9, 
   3.601638202325562*^9}, {3.6016382578307657`*^9, 3.60163826189983*^9}, {
   3.601638295100423*^9, 3.601638308015642*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"probNShrimpLive", "[", 
      RowBox[{"3", ",", "k", ",", 
       RowBox[{"{", 
        RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"probNShrimpLive", "[", 
      RowBox[{"4", ",", "k", ",", 
       RowBox[{"{", 
        RowBox[{".1", ",", ".1", ",", ".1", ",", ".7"}], "}"}]}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"probNShrimpLive", "[", 
      RowBox[{"5", ",", "k", ",", 
       RowBox[{"{", 
        RowBox[{".1", ",", ".1", ",", ".1", ",", ".7"}], "}"}]}], "]"}], ",", 
     
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "3"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdxUsogwEAB/DPcmDnXcwSbUiaZpFIE5M85jHSDmpt8moyIjaP2dqYYYm1
5bITrc3BQYmRA0nJY2PLfBblEZs1HIyUyPd3+PVLa+1tbKcRBMGiYHecyzd+
ESntzjYGsdjSn6alrjwguThatcPHdoG2CStHzlvw1+mCFA+8fynwTyTXhDkb
PWacoLicw9V1Aivu2+xcxLxm7z1m3tne8Jns6QP7FYWEjrp1O5SILQ4RGwfM
gSxs9wiFeChztR67Cr4bsHjpUYln5UlqfOScH8OyHKkOsz4PTXg5VTeNU6I/
a3rq2K1yB2ue23Zxes3kAc5nqrz4V24jMen0lBmoCRqjHJ+sRHYnqPM6lXs4
PMj2YQZZdIM7JA8veF3EfcWW2mK6lZofE/5PDzlUOGzLGMZdo3V6zPNLDFij
Tp7C8SXWGWy+3jrGnH23BxsrBq7weOAziP8AZkgDpw==
  "]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5120000000000001`", ",", "0.43400000000000016`", ",", 
   "0.05400000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{{3.601638470280365*^9, 3.601638485102206*^9}, {
   3.601638990429665*^9, 3.601639031694518*^9}, 3.601639116313199*^9, 
   3.6016469625102997`*^9, 3.6018714828996677`*^9, 3.602080582536961*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.24009999999999992`", ",", "0.5084999999999998`", ",", 
   "0.23099999999999998`", ",", "0.0204`"}], "}"}]], "Output",
 CellChangeTimes->{{3.601638470280365*^9, 3.601638485102206*^9}, {
   3.601638990429665*^9, 3.601639031694518*^9}, 3.601639116313199*^9, 
   3.6016469625102997`*^9, 3.6018714828996677`*^9, 3.602080582583434*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.16806999999999994`", ",", "0.47882999999999987`", ",", "0.3096`", ",", 
   "0.043500000000000004`"}], "}"}]], "Output",
 CellChangeTimes->{{3.601638470280365*^9, 3.601638485102206*^9}, {
   3.601638990429665*^9, 3.601639031694518*^9}, 3.601639116313199*^9, 
   3.6016469625102997`*^9, 3.6018714828996677`*^9, 3.602080582680463*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.601638437480421*^9, 3.601638445442049*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FindNearestShrimp", "[", 
    RowBox[{"shrimpPositions_", ",", "p_"}], "]"}], ":=", 
   RowBox[{"Nearest", "[", 
    RowBox[{
     RowBox[{"Map", " ", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Apply", "[", 
         RowBox[{"Rule", ",", "#"}], "]"}], "&"}], ",", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"shrimpPositions", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "shrimpPositions", "]"}], "]"}]}], "}"}], 
        "]"}]}], "]"}], ",", "p"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindNearestShrimp", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{".25", ",", ".5", ",", ".75"}], "}"}], ",", " ", ".9"}], "]"}], 
  "[", 
  RowBox[{"[", "1", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.601749111670476*^9, 3.601749173849326*^9}, {
   3.601749267582487*^9, 3.6017493351633577`*^9}, {3.601750117042459*^9, 
   3.601750134583912*^9}, {3.60175336462693*^9, 3.601753394655057*^9}, {
   3.6017534751255493`*^9, 3.6017535215698433`*^9}, {3.601753578622013*^9, 
   3.6017535911810617`*^9}, {3.601753638571163*^9, 3.601753664827627*^9}, {
   3.6017537758204193`*^9, 3.601753788297892*^9}, {3.601753821585416*^9, 
   3.6017538588097363`*^9}, {3.601754130005447*^9, 3.601754141981681*^9}, {
   3.601754194007194*^9, 3.601754270455233*^9}, {3.601754317669087*^9, 
   3.6017543385073*^9}, {3.601754407607876*^9, 3.601754433925042*^9}, {
   3.601754478185751*^9, 3.601754523679234*^9}, {3.601754642302104*^9, 
   3.6017546437324743`*^9}, {3.6018119285435667`*^9, 3.601811965371273*^9}, {
   3.6018119976631737`*^9, 3.601812090695767*^9}, {3.601812124727543*^9, 
   3.601812141868544*^9}, 3.601815779163306*^9, {3.6018158414688396`*^9, 
   3.601815843100996*^9}}],

Cell[BoxData["3"], "Output",
 CellChangeTimes->{{3.601812127493164*^9, 3.601812142283058*^9}, 
   3.601815779768818*^9, 3.601815844370797*^9, 3.601871483114912*^9, 
   3.602080582784432*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PointInNeighborhood", "[", 
      RowBox[{
      "shrimppositions_", ",", "shrimpindex_", ",", "p_", ",", " ", "eps_"}], 
      "]"}], ":=", " ", 
     RowBox[{
      RowBox[{"Abs", "[", 
       RowBox[{
        RowBox[{"shrimppositions", "[", 
         RowBox[{"[", "shrimpindex", "]"}], "]"}], "-", "p"}], "]"}], " ", 
      "\[LessEqual]", " ", "eps"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Experiment", "[", 
      RowBox[{"shrimpPositions_", ",", "eps_"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"p", ",", "shrimpindex"}], "}"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"p", " ", "=", " ", 
         RowBox[{"RandomReal", "[", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"shrimpindex", " ", "=", " ", 
         RowBox[{
          RowBox[{"FindNearestShrimp", "[", 
           RowBox[{"shrimppositions", ",", " ", "p"}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"PointInNeighborhood", "[", 
           RowBox[{
           "shrimppositions", ",", "shrimpindex", ",", "p", ",", "eps"}], 
           "]"}], ",", "\[IndentingNewLine]", "shrimpindex", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"1", "+", 
           RowBox[{"Length", "[", "shrimppositions", "]"}]}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Trials", "[", 
     RowBox[{"shrimpPositions_", ",", "eps_", ",", "ntrials_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"k", ",", "x", ",", "tally", ",", "xout", ",", "counts"}], 
       "}"}], ",", "\[IndentingNewLine]", "       ", 
      RowBox[{
       RowBox[{"x", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Experiment", "[", 
           RowBox[{"shrimpPositions", ",", "eps"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "ntrials"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "       ", 
       RowBox[{"tally", " ", "=", " ", 
        RowBox[{"Tally", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
       "      ", 
       RowBox[{"xout", " ", "=", " ", 
        RowBox[{"Table", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", 
            RowBox[{
             RowBox[{"Length", "[", "shrimppositions", "]"}], "+", "1"}]}], 
           "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", "      ", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"xout", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"tally", "[", 
              RowBox[{"[", "k", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"tally", "[", 
            RowBox[{"[", "k", "]"}], "]"}], "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", 
           RowBox[{"Length", "[", "tally", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "      ", 
       RowBox[{
        RowBox[{
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"#", " ", ">", "0"}], " ", ",", " ", "1", ",", " ", 
              "0"}], "]"}], "&"}], ",", " ", "xout"}], "]"}], " ", "//", " ", 
         
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{"#", ",", 
            RowBox[{"-", "1"}]}], "]"}], "&"}]}], " ", "//", " ", 
        "Total"}]}]}], " ", "\[IndentingNewLine]", "     ", "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ComputeCounts", "[", 
     RowBox[{
     "shrimppositions_", ",", "eps_", ",", "ntrials_", ",", "ntimes_"}], 
     "]"}], " ", ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tally", ",", "counts"}], "}"}], ",", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{
       RowBox[{"counts", " ", "=", " ", 
        RowBox[{
         RowBox[{"Table", "[", " ", 
          RowBox[{
           RowBox[{"Trials", "[", 
            RowBox[{"shrimppositions", ",", "eps", ",", "ntrials"}], "]"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "ntimes"}], "}"}]}], "]"}], " ", "//", " ", 
         RowBox[{
          RowBox[{"Tally", "[", "#", "]"}], "&"}]}]}], " ", ";", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{"tally", " ", "=", " ", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"#", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "/", "ntimes"}], " ", "//", 
              "N"}]}], "}"}], "&"}], ",", " ", "counts"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "  ", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "&"}], ",", 
         RowBox[{"Sort", "[", 
          RowBox[{"tally", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "<", 
             RowBox[{"#2", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], "&"}]}], "]"}]}], " ", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"shrimppositions", "=", 
     RowBox[{"{", 
      RowBox[{".25", ",", ".5"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", " ", "=", " ", 
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"eps", " ", "=", ".05"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ntrials", "=", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ntimes", " ", "=", "5000"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"ComputeCounts", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{".1", ",", ".1", ",", ".8"}], "}"}], ",", ".05", ",", "3", ",", 
     "3000"}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"probNShrimpLive", "[", 
      RowBox[{"3", ",", "k", ",", 
       RowBox[{"{", 
        RowBox[{".1", ",", ".1", ",", ".8"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "0", ",", "2"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.601749111670476*^9, 3.601749173849326*^9}, {
   3.601749267582487*^9, 3.6017493351633577`*^9}, {3.601750117042459*^9, 
   3.601750134583912*^9}, {3.60175336462693*^9, 3.601753394655057*^9}, {
   3.6017534751255493`*^9, 3.6017535215698433`*^9}, {3.601753578622013*^9, 
   3.6017535911810617`*^9}, {3.601753638571163*^9, 3.601753664827627*^9}, {
   3.6017537758204193`*^9, 3.601753788297892*^9}, {3.601753821585416*^9, 
   3.6017538588097363`*^9}, {3.601754130005447*^9, 3.601754141981681*^9}, {
   3.601754194007194*^9, 3.601754270455233*^9}, {3.601754317669087*^9, 
   3.6017543385073*^9}, {3.601754407607876*^9, 3.601754433925042*^9}, {
   3.601754478185751*^9, 3.601754523679234*^9}, {3.601754642302104*^9, 
   3.6017546437324743`*^9}, {3.6018119285435667`*^9, 3.601811965371273*^9}, {
   3.6018119976631737`*^9, 3.601812090695767*^9}, {3.601812124727543*^9, 
   3.6018123760474463`*^9}, {3.60181240937868*^9, 3.601812520288727*^9}, {
   3.601812700050166*^9, 3.601812771677455*^9}, {3.601812870193293*^9, 
   3.601812886679627*^9}, {3.6018129229662867`*^9, 3.60181297208994*^9}, {
   3.6018130358279333`*^9, 3.601813188087969*^9}, {3.601813228430155*^9, 
   3.60181341668355*^9}, {3.60181348456857*^9, 3.6018135578862333`*^9}, {
   3.601813679943079*^9, 3.601813795149355*^9}, {3.6018139173268633`*^9, 
   3.601813922994011*^9}, {3.6018139653232603`*^9, 3.601813979967424*^9}, 
   3.601814074526493*^9, {3.6018141142950478`*^9, 3.6018143396006517`*^9}, {
   3.601814389468411*^9, 3.6018146318718*^9}, {3.601814692574868*^9, 
   3.601814811775312*^9}, {3.601814844529531*^9, 3.601815177942803*^9}, {
   3.601815210240676*^9, 3.601815210830254*^9}, {3.601815360816999*^9, 
   3.601815367159259*^9}, {3.601815404403392*^9, 3.601815606837195*^9}, {
   3.601815677644473*^9, 3.601815711609933*^9}, {3.6018157971230803`*^9, 
   3.6018158169239483`*^9}, {3.601815850658409*^9, 3.601815931265953*^9}, {
   3.601815980079679*^9, 3.601815983767872*^9}, {3.6018160171603518`*^9, 
   3.601816127880825*^9}, 3.60181617003846*^9, {3.601837891400649*^9, 
   3.601837893003235*^9}, {3.6018379290373907`*^9, 3.601837955150875*^9}, {
   3.60183800938017*^9, 3.6018380173736553`*^9}, {3.601838054464031*^9, 
   3.601838073444274*^9}, {3.6018383104619617`*^9, 3.6018383883810368`*^9}, {
   3.601838488494213*^9, 3.601838618196023*^9}, {3.601838694295258*^9, 
   3.601838872833552*^9}, {3.601838911917581*^9, 3.601839134269814*^9}, {
   3.601839179648336*^9, 3.601839389699918*^9}, {3.601871540314357*^9, 
   3.601871544388942*^9}, {3.6020802884278107`*^9, 3.6020802987414303`*^9}, {
   3.602080332640608*^9, 3.60208034005791*^9}, {3.602080378682509*^9, 
   3.602080593791174*^9}, {3.6020806467361517`*^9, 3.602080794150326*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5196666666666667`", ",", "0.426`", ",", "0.05433333333333333`"}],
   "}"}]], "Output",
 CellChangeTimes->{{3.601838733512301*^9, 3.601838743416198*^9}, {
   3.601838777552174*^9, 3.601838873271529*^9}, 3.601838921529546*^9, {
   3.601838952542766*^9, 3.601839037305031*^9}, {3.6018391169456167`*^9, 
   3.6018391457766447`*^9}, {3.601839211709099*^9, 3.601839252914896*^9}, {
   3.6018392833125277`*^9, 3.601839402868785*^9}, 3.6018714842259197`*^9, 
   3.601871545954084*^9, {3.6020805267229347`*^9, 3.602080595247797*^9}, 
   3.602080648579227*^9, {3.602080701447597*^9, 3.602080716137999*^9}, {
   3.602080748061839*^9, 3.602080795325182*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5120000000000001`", ",", "0.43400000000000016`", ",", 
   "0.05400000000000002`"}], "}"}]], "Output",
 CellChangeTimes->{{3.601838733512301*^9, 3.601838743416198*^9}, {
   3.601838777552174*^9, 3.601838873271529*^9}, 3.601838921529546*^9, {
   3.601838952542766*^9, 3.601839037305031*^9}, {3.6018391169456167`*^9, 
   3.6018391457766447`*^9}, {3.601839211709099*^9, 3.601839252914896*^9}, {
   3.6018392833125277`*^9, 3.601839402868785*^9}, 3.6018714842259197`*^9, 
   3.601871545954084*^9, {3.6020805267229347`*^9, 3.602080595247797*^9}, 
   3.602080648579227*^9, {3.602080701447597*^9, 3.602080716137999*^9}, {
   3.602080748061839*^9, 3.602080795371851*^9}}]
}, Open  ]]
},
WindowSize->{1323, 763},
WindowMargins->{{Automatic, 9}, {Automatic, 0}},
FrontEndVersion->"8.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (August 26, \
2012)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 358, 7, 31, "Input",
 Evaluatable->False],
Cell[918, 29, 5978, 183, 586, "Input",
 Evaluatable->False],
Cell[6899, 214, 1960, 53, 97, "Input"],
Cell[CellGroupData[{
Cell[8884, 271, 1302, 26, 118, "Input"],
Cell[10189, 299, 354, 7, 27, "Output"]
}, Open  ]],
Cell[10558, 309, 92, 1, 27, "Input"],
Cell[10653, 312, 92, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[10770, 317, 619, 10, 29, "Input"],
Cell[11392, 329, 268, 5, 21, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11697, 339, 2579, 66, 112, "Input"],
Cell[14279, 407, 362, 8, 27, "Output"]
}, Open  ]],
Cell[14656, 418, 468, 12, 57, "Input"],
Cell[CellGroupData[{
Cell[15149, 434, 3135, 68, 73, "Input"],
Cell[18287, 504, 397, 5, 27, "Output"],
Cell[18687, 511, 399, 5, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19123, 521, 2061, 37, 103, "Input"],
Cell[21187, 560, 294, 7, 27, "Output"]
}, Open  ]],
Cell[21496, 570, 91, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[21612, 575, 1975, 36, 88, "Input"],
Cell[23590, 613, 270, 7, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23897, 625, 2541, 49, 88, "Input"],
Cell[26441, 676, 330, 8, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26808, 689, 2345, 45, 58, "Input"],
Cell[29156, 736, 332, 8, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29525, 749, 2694, 52, 58, "Input"],
Cell[32222, 803, 160, 2, 27, "Output"]
}, Open  ]],
Cell[32397, 808, 2573, 48, 73, "Input"],
Cell[CellGroupData[{
Cell[34995, 860, 1557, 41, 103, "Input"],
Cell[36555, 903, 358, 7, 27, "Output"],
Cell[36916, 912, 374, 7, 27, "Output"],
Cell[37293, 921, 376, 7, 27, "Output"]
}, Open  ]],
Cell[37684, 931, 92, 1, 27, "Input"],
Cell[CellGroupData[{
Cell[37801, 936, 1800, 38, 43, "Input"],
Cell[39604, 976, 190, 3, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39831, 984, 10016, 231, 703, "Input"],
Cell[49850, 1217, 688, 11, 27, "Output"],
Cell[50541, 1230, 706, 12, 27, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
